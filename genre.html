<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>Genre Results - GomoTV</title>
Â  <link rel="stylesheet" href="style.css" />
Â  <script src="shared-modal.js"></script>

Â  <!-- âœ… Import disclaimer module -->
Â  <script type="module">
Â  Â  import { addPaginationDisclaimer, disclaimerStyle } from './shared-disclaimer.js';

Â  Â  // Apply disclaimer CSS
Â  Â  const style = document.createElement('style');
Â  Â  style.textContent = disclaimerStyle;
Â  Â  document.head.appendChild(style);

Â  Â  // Optional: if you want it triggered globally
Â  Â  // document.addEventListener('DOMContentLoaded', addPaginationDisclaimer);
Â  </script>
</head>
<body>
Â  <header class="navbar">
Â  Â  <button onclick="history.back()" class="menu-toggle">â†</button>
Â  Â  <h1 class="logo" id="genre-title">Genres</h1>
Â  Â  <button id="theme-toggle" class="theme-toggle">ğŸŒ“</button>
Â  </header>

Â  <section style="padding: 20px;">
Â  Â  <div class="genre-list">
Â  Â  Â  <h2>ğŸ­ Select a Genre:</h2>
Â  Â  Â  <div class="genre-grid">
Â  Â  Â  Â  <a href="genre.html?name=Action&id=28">Action</a>
Â  Â  Â  Â  <a href="genre.html?name=Animation&id=16">Animation</a>
Â  Â  Â  Â  <a href="genre.html?name=Comedy&id=35">Comedy</a>
Â  Â  Â  Â  <a href="genre.html?name=Drama&id=18">Drama</a>
Â  Â  Â  Â  <a href="genre.html?name=Fantasy&id=14">Fantasy</a>
Â  Â  Â  Â  <a href="genre.html?name=Horror&id=27">Horror</a>
Â  Â  Â  Â  <a href="genre.html?name=Romance&id=10749">Romance</a>
Â  Â  Â  Â  <a href="genre.html?name=Sci-Fi&id=878">Sci-Fi</a>
Â  Â  Â  Â  <a href="genre.html?name=Thriller&id=53">Thriller</a>
Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  <main>
Â  Â  <div id="pagination-top" class="pagination"></div>
Â  Â  <div class="search-results-grid" id="results-grid"></div>
Â  Â  <div id="pagination" class="pagination"></div>
Â  </main>

Â  <div id="modal-container"></div>

Â  <script>
Â  Â  const API_KEY = '77312bdd4669c80af3d08e0bf719d7ff';
Â  Â  const params = new URLSearchParams(location.search);
Â  Â  const genreId = params.get('id');
Â  Â  const genreName = params.get('name');
Â  Â  let currentPage = parseInt(params.get('page')) || 1;

Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  initThemeToggle();
Â  Â  Â  if (genreId && genreName) {
Â  Â  Â  Â  document.getElementById("genre-title").textContent = "ğŸ­ " + genreName;
Â  Â  Â  Â  fetchGenreMovies(genreId, currentPage);
Â  Â  Â  }
Â  Â  });

Â  Â  function getImageUrl(path) {
Â  Â  Â  return path
Â  Â  Â  Â  ? `https://image.tmdb.org/t/p/w500${path}`
Â  Â  Â  Â  : 'https://via.placeholder.com/500x750?text=No+Poster';
Â  Â  }

Â  Â  async function fetchGenreMovies(id, page = 1) {
Â  Â  Â  const res = await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&with_genres=${id}&page=${page}`);
Â  Â  Â  const data = await res.json();
Â  Â  Â  renderResults(data.results);
Â  Â  Â  renderPagination(data.total_pages);
Â  Â  }

Â  Â  function renderResults(items) {
Â  Â  Â  const container = document.getElementById("results-grid");
Â  Â  Â  container.innerHTML = items.map(item => {
Â  Â  Â  Â  const title = item.title || item.name;
Â  Â  Â  Â  const year = (item.release_date || item.first_air_date || '').slice(0, 4);
Â  Â  Â  Â  const img = getImageUrl(item.poster_path);

Â  Â  Â  Â  return `
Â  Â  Â  Â  Â  <div class="poster-wrapper">
Â  Â  Â  Â  Â  Â  <img src="${img}" alt="${title}" data-id="${item.id}" data-type="movie">
Â  Â  Â  Â  Â  Â  <div class="poster-label">${title}</div>
Â  Â  Â  Â  Â  Â  <div class="poster-meta">ğŸ“… ${year}</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  }).join('');

Â  Â  Â  document.querySelectorAll('.poster-wrapper img').forEach(img => {
Â  Â  Â  Â  img.addEventListener('click', () => {
Â  Â  Â  Â  Â  openModal(img.dataset.id, img.dataset.type);
Â  Â  Â  Â  });
Â  Â  Â  });

Â  Â  Â  // âœ… Add disclaimer AFTER rendering results + pagination
Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  if (typeof addPaginationDisclaimer === 'function') {
Â  Â  Â  Â  Â  addPaginationDisclaimer();
Â  Â  Â  Â  }
Â  Â  Â  }, 0);
Â  Â  }

Â  Â  function renderPagination(totalPages) {
Â  Â  Â  const pagTop = document.getElementById('pagination-top');
Â  Â  Â  const pagBottom = document.getElementById('pagination');
Â  Â  Â  if (totalPages <= 1) {
Â  Â  Â  Â  pagTop.innerHTML = '';
Â  Â  Â  Â  pagBottom.innerHTML = '';
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  let buttons = '';
Â  Â  Â  const minPage = Math.max(1, currentPage - 2);
Â  Â  Â  const maxPage = Math.min(totalPages, currentPage + 2);

Â  Â  Â  if (currentPage > 1) buttons += `<button onclick="goToPage(${currentPage - 1})">Â« Prev</button>`;
Â  Â  Â  for (let i = minPage; i <= maxPage; i++) {
Â  Â  Â  Â  buttons += `<button onclick="goToPage(${i})" ${i === currentPage ? 'class="active"' : ''}>${i}</button>`;
Â  Â  Â  }
Â  Â  Â  if (currentPage < totalPages) buttons += `<button onclick="goToPage(${currentPage + 1})">Next Â»</button>`;

Â  Â  Â  pagTop.innerHTML = buttons;
Â  Â  Â  pagBottom.innerHTML = buttons;
Â  Â  }

Â  Â  function goToPage(page) {
Â  Â  Â  location.href = `genre.html?name=${encodeURIComponent(genreName)}&id=${genreId}&page=${page}`;
Â  Â  }

Â  Â  function initThemeToggle() {
Â  Â  Â  const toggleBtn = document.getElementById('theme-toggle');
Â  Â  Â  if (!toggleBtn) return;
Â  Â  Â  const currentTheme = localStorage.getItem('theme') || 'dark';
Â  Â  Â  document.body.classList.add(currentTheme);
Â  Â  Â  toggleBtn.textContent = 'ğŸŒ“';
Â  Â  Â  toggleBtn.addEventListener('click', () => {
Â  Â  Â  Â  const isDark = document.body.classList.contains('dark');
Â  Â  Â  Â  document.body.classList.toggle('dark', !isDark);
Â  Â  Â  Â  document.body.classList.toggle('light', isDark);
Â  Â  Â  Â  localStorage.setItem('theme', isDark ? 'light' : 'dark');
Â  Â  Â  });
Â  Â  }
Â  </script>
</body>
</html>
